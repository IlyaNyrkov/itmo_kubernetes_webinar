# Вебинар по kubernetes для ИТМО

## Задание

*Рекомендуется выполнять в minikube или в vk cloud.*

Установить minikube можно по [инструкции](https://minikube.sigs.k8s.io/docs/start/).

Создать кластер в vk cloud можно по [инструкции](https://mcs.mail.ru/docs/ru/base/k8s/operations/create-cluster/create-webui).

В данном задании предлагается развернуть простое http-приложение в kubernetes, развернуть для него автомасштабирование и подать нагрузку для демонстрации работы.

*В папке example описан пример выполнения этого задания.*

### Часть 1

1) Установить minikube / создать кластер в vk cloud.

2) Запустить minikube / [подключиться](https://mcs.mail.ru/docs/ru/base/k8s/connect/kubectl) к кластеру в vk cloud.

3) Подготовить любое приложение с минимум одной http-ручкой, которую можно вызвать в рамках тестирования утилитами для отправки HTTP запросов вроде curl, wget, HTTPie, Postman.

4) Собрать docker-образ приложения и добавить в minikube / [docker registry](https://mcs.mail.ru/docs/ru/base/k8s/connect/docker-registry) кластера в vk cloud.

5) Написать манифест для деплоймента приложения в кластер. В деплойменте должен быть описан репликасет с образом приложения, который был добавлен ранее.

6) Применить написанный манифест на кластере.

7) Сделать port-forwarding на localhost/minikube tunnel/настроить [ingress controller в vk cloud](https://mcs.mail.ru/docs/ru/base/k8s/use-cases/ingress) для доступа к кластеру извне и тестирования работы приложения.

8) Отправить http-запрос на приложение в kubernetes одним из описанных выше приложений.

### Часть 2

1) Остановить, запущенное ранее, приложение или удалите deployment, созданный при помощи манифеста.

2) Настроить автоскейлинг подов по [инструкции](https://blog.devops.dev/guide-to-kubernetes-autoscaling-a7dcd14a894).

3) Запустить приложение с новыми настройками.

4) Подать нагрузку на приложение инструментом для нагрузочного тестирования: K6, JMeter, Gatling или при помощи пода load-generator, как в примере **example/**.

5) Продемонстрировать работу автоскейлинга командой, в выводе которой должны появится новые поды, созданные в дополнении к созданным deployment'ом:
```bash
kubectl get pods
```

### Часть 3

Если есть желание пойти дальше, можно настроить взаимодействие приложения с базой данных и автоматический деплой в кластере kubernetes при пуше в репозитрой гитлаба и прохождении пайплайна, подробнее в статье [запуск проекта в Kubernetes за 60 минут](https://habr.com/ru/company/vk/blog/565250/).